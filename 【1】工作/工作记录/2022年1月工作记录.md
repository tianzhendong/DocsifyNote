[toc]

# 2020年12月

## 2021年12月23日

1. 上午，CodeSYS软件安装，工会选举（30分钟，替曹宸旭）
2. 下午，自动换刀机器人实验室联试3. CodeSYS学习
   明日：参加社招人员培训

## 2021年12月27日

> **CodeSYS学习**

plc控制器输出是什么？控制的是线圈，控制量是什么？

>  **实验室联试（自动换刀机器人）

**出现问题**：测试程序检测不到机械爪的电压信号，（电压信号由压力信号转换而来）

找原因：

1. 程序测试，无信号在plc端用电压表测试，无电压信号，故障定位在plc端之前
2. 在机械臂末端的接线端子用电压表测试，无信号，故障定位在接线端子之前
3. 在压力传感器直接测试，发现有信号，故障定位在压力传感器和接线端子之间的线
4. 将压力传感器端的线进行短接，在接线端子端用电阻表进行测量，发现黑白两根线都不通

后续解决：明天继续

## 2021年12月28日

**（1）换刀机器人试验**

主要内容：解决压力传感器无信号问题拆线、接线、焊线，棕正蓝负白信号，黑色线无用

**（2）英姐培训**

## 2021年12月30日

> （1）红绿灯PLC程序

> （2）机器人控制组会议分工

1. 专利、论文编写

之前做的成果由于工作较忙，没有形成论文等成果，后续补充，重视论文、专利

当前主要是完成清渣机项目专利编写，采用线激光或者结构光识别清渣机上的钢拱架，识别后用机械臂清理钢拱架之间的垃圾

线激光安装在上部，识别顶部的钢拱架，避免底部因为有垃圾覆盖出现识别问题

目标：两周完成线激光方案专利初稿

2. 控制程序

之前清渣机有两版，两个机械臂，控制程序相互独立，并且采用不同的plc实现，目标是实现一个机柜控制了两个机械臂

当前阶段任务：将其中一个机械臂控制起来（该机械臂目前采用的是西门子的S7-1500plc，控制程序使用TIA Portal博途编写，控制程序由电气分院编写，是一个黑盒，未对我们开放接口），目标是自己编写控制程序将其控制起来

> （3）TIA博途软件安装以及简单使用学习

> （4）晚上6点-8：30，创新分院茶话会

# 2022年1月

## 2022年1月4日

> （1）专利

与一新讨论，确定范围和大致内容，纠正了方向，一种掘进机自动清渣方案与系统

收集相关专利、文献资料，相关论文较少，专利多一点

编写背景技术，确定工作流程问题：确定是系统还是方法？

> （2）李正道实验室调试清渣机的变频电机，参与学习

目前两个机械臂，用两个不同的pLC控制

老的机械臂用的是西门子的plc，TIA博途编程（左边那个），包括三个油缸和三个电机，电机：两个控制前后，一个控制回转

新的是自由度更高的机械臂（右边那个），用的是codesys编程

目前想法是用右边机械臂的plc同时控制老的三个电机，解决思路是用一根网线连接新的plc

> （3）清渣机博途编程用博途重新实现老的机械臂的编程，晚上梳理了其程序工作流程，大致搞懂了逻辑

## 2022年1月5日

> （1）清渣机控制程序

在TIA博途中编写控制程序

参考原有的，主要逻辑没有变

> 收获：

* TIA博途中结构化文本为SCL，STL为指令表语言

* 结构化文本和codesys中调用函数、功能块方式不同

* 变量：input、output、全局、静态、变量池、IO变量

## 2022年1月6日

> （1）清渣机控制

- 简单修改了以下油缸的控制逻辑，修改内容较小
- 目前问题：感觉过于简单、粗糙，需要细化

待办：

* 变频电机控制逻辑尚未搞懂，之前是厂家写的模块，用的指令表语言，需要花时间研究

* 目前控制逻辑感觉过于简单、粗糙，需要细化

- 博途编程软件的使用，细节

> （2）清渣机专利

工作内容：

- 完成了初稿，参考颜明的专利，完成了现有技术分析、具体技术方案和内容、保护的技术创新点、发明目的、预计收益部分
- 做了工作流程图，和一新核对了工作的具体流程

待办：

- 系统组件图需要更改，描述出运输带和滑轨等机构
- 工作流程需要审核
- 初稿审阅

## 2022年1月10日

> （1）清渣机专利

远洋给了些意见，根据意见进行了修改，并交给了一新

> （2）实验室

观看远洋和正道调试清渣机的回转和前后电机

> （3）清渣机控制程序

plc指针-寄存器地址知识学习

## 2022年1月11日

清渣机控制程序电机控制部分

## 2022年1月12日

> （1）清渣机控制程序

油缸部分，采用PID控制，重新编写了控制程序

了解了博途DB数据区和M区的区别

> （2）实验室调试

主要调试油缸

清渣机液压：先开实验室总液压开关，把里面三个风扇的黑色开关全部按下，然后外部按下按钮（写着小），再去开清渣机的液压泵入流阀，臂的阀有两个，左边是老的机械臂，右边是新的

学习了如何调试，调试的过程

问题：连接plc.显示固件版本不兼容，无法转至在线怎么办

两种办法：

一， 在博图中更改设备类型，选择与PLC相对应的硬件版本（见附图）

二，升级PLC的固件版本，你所用的PLC型号比较老，不支持在线更新固件，需要张卡来来进行固件更新。买张卡，到官网上下载相应的固件版本。在线帮助信息里面有该方面的指导。

## 2022年1月13日

LABVIEW上位机程序和西门子博途软件通过tcp进行通信

研究

## 2022年1月14日

LABVIEW上位机程序和西门子博途软件通过tcp进行通信

实验室测试

## 2022年1月17日

> （1）清渣机控制程序

ModbusTCP和TCP通讯继续研究，测试

下午实验室测试，ModbusTCP没成功

TCP通讯测试成功，找到了之前labview和plc通讯失败的原因：

由于之前设置了防火墙，把labview关闭了联网功能，因此只能连接127.0.0.1，连接其他ip时会连接失败

> （2）后续工作

远洋让研究profinet通讯，把西门子的s71500plc作为PN从站，通过上级plc进行控制，晚上看了原理，好像挺简单，只需要配置一下io地址，然后连接plc导出GSD文件即可，明天测试

## 2022年1月18日

> 亮哥交待柔臂工作

之前柔臂的控制是由哈工程的写的，未给源程序，需要我们自己再写一个。

柔臂掘进机，是一种六自由度振动台，工作原理、控制原理等

设计控制程序时，主要是根据轨迹，求出反解，得到六个油缸的伸缩量，从而对六个油缸进行控制。

难点：初始化动作、**保护动作**、反解

 

## 2022年1月19日

> 管片拼装机

博士让搞管片拼装机工作，和亮哥交接了一下

之前是上海交大写的控制程序，两个PLC方案，S7-300+S7-1500，没有闭环

**目标**：和张培配合，采用视觉相机，进行闭环控制，实现自动化

途径：采用单个PLC方案

## 2022年1月20日

> 管片拼装机

根据亮哥发的之前交大写的电气原理图和控制方案、控制逻辑，进行梳理，行程文稿，研究

亮哥要了交大的程序，看了交大的程序，逻辑清晰，值得学习

## 2022年1月21日

> 管片拼装机

交大的程序学习，KF、控制逻辑、安全逻辑

将交大的程序移植到codesys上

## 2022年1月24日

> 管片拼装机

自动化拼装逻辑、流程设计

之前理解有误，目前采用单目相机，只能获取相机的前方Y和左右X轴两个方向的位置

## 2022年1月25日

> 管片拼装机

向交大魏齐交流学习，了解了ctrl_sr_btn的作用和整个的控制逻辑

* ctrl_sr_btn松开时宏观运动（没有使能，只有程序上的逻辑控制），ctrl_sr_btn按下时小运动
* 安装管片时有12个油缸顶着

编写了取管片时的程序，并设计了位置命令更新逻辑

> 柔臂

温度采集程序

* 学习了模拟量输入输出段子的接线和作用
* 学习了Labview打包安装包的过程
* 学习了codesys添加从站、modbus从站的方法
* 学习了codesys添加模块的方法

## 2022年1月26日

> 管片拼装机

程序修改

> modbusTCP

理论研究、TIA Portal中使用、QTmodbusTCP学习

## 2022年1月27日

ModbusTCP研究，QT编程

